<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="master.macros['master']">
<head>
  <title>Showroom</title>
</head>

<body>

<!-- header -->
<div id="header">

  <!-- user -->
  <div metal:fill-slot="header" id="user_ID">
      ${logged_in}
      <a href='${request.application_url}/logout'>disconnect</a>
  </div>
</div>

<div id="content" metal:fill-slot="content">

  <!-- form to create a demo -->
  <div id="app_form" class="subcontent">
    <form method="POST"
          action="${request.application_url}/deploy">
        <div>
        <span>create a demo</span>
        <select name="app"
                onchange="update_app_form('${request.application_url}', this.value)">
        <option></option>
        <option tal:repeat="app apps" tal:content="python:app">placeholder</option>
        </select>
        </div>
        <span id="app_form_dynamic"></span>
        <img id="loading" style="display:none;"
        src="static/images/loading.gif" />
    </form>
  </div>

  <!-- message -->
  <tal:block define="session python:request.environ.get('beaker.session', {})"
             condition="session.has_key('message')">
  <div id="message" class="subcontent"
       tal:define="message python:session.pop('message', None)"
       tal:content="structure message" />
  <div tal:replace="python:session.save() or ''" />
  </tal:block>

  <!-- demo list -->
  <div id="demos_list" class="subcontent">
  <table>
    <tr tal:repeat="demo demos">
      <td>
        <div class="STOPPED"
             tal:attributes="class python:'status ' + demo.get('status'); title python:demo.get('status')"
             tal:content="python:demo.get('status')">
       </div>
      </td>
      <td class="demo_title">
        <a tal:attributes="href python: proxied_url(demo, request)"
           tal:content="python: demo.get('name')">
            app name
        </a>
      </td>
      <td class="demo_title">
        <a tal:attributes="href python: direct_url(demo, request)">
            (direct link)
        </a>
      </td>
      <td class="demo_button">
        <a href="#" class="start"
           tal:condition="python: demo['status'] == 'STOPPED'"
           tal:attributes="href string:/start?name=${demo['name']}">
          start
        </a>
        <a href="#" class="stop"
           tal:condition="python: demo['status'] == 'RUNNING'"
           tal:attributes="href string:/stop?name=${demo['name']}">
          stop
        </a>
      </td>
      <td class="demo_button">
        <a href="#" class="destroy"
           onclick="if(!confirm('Do you really want to destroy this demo? This cannot be undone')) {return false;}"
           tal:condition="python: demo['status'] == 'STOPPED'"
           tal:attributes="href string:/destroy?name=${demo['name']}">
          destroy
        </a>
      </td>
    </tr>
  </table>
  </div>
</div>


<!-- start footer -->
<div colspan="2" id="footer">
    Powered by <a href="http://www.pylonsproject.org/">Pyramid</a>
    - <a href="https://bitbucket.org/ccomb/showroom">Source code</a>
    - copyleft <a href="http://ccomb.gorfou.fr">Christophe Combelles</a> 2010-2011
</div>

</body>
</html>
